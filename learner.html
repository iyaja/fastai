<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Learner</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="Welcome to fastai">
    <link rel="preload" href="/fastai/assets/css/0.styles.24b54ae9.css" as="style"><link rel="preload" href="/fastai/assets/js/app.e4c088e4.js" as="script"><link rel="preload" href="/fastai/assets/js/2.f1c4f916.js" as="script"><link rel="preload" href="/fastai/assets/js/30.248393fd.js" as="script"><link rel="prefetch" href="/fastai/assets/js/10.99994145.js"><link rel="prefetch" href="/fastai/assets/js/11.08687312.js"><link rel="prefetch" href="/fastai/assets/js/12.40b88a98.js"><link rel="prefetch" href="/fastai/assets/js/13.83861397.js"><link rel="prefetch" href="/fastai/assets/js/14.3a1586b8.js"><link rel="prefetch" href="/fastai/assets/js/15.1cbd093c.js"><link rel="prefetch" href="/fastai/assets/js/16.c850565b.js"><link rel="prefetch" href="/fastai/assets/js/17.9c3f07b2.js"><link rel="prefetch" href="/fastai/assets/js/18.db37b5bb.js"><link rel="prefetch" href="/fastai/assets/js/19.c91272fe.js"><link rel="prefetch" href="/fastai/assets/js/20.a9c5f90d.js"><link rel="prefetch" href="/fastai/assets/js/21.e40307f7.js"><link rel="prefetch" href="/fastai/assets/js/22.8fcdc465.js"><link rel="prefetch" href="/fastai/assets/js/23.14fb4a2d.js"><link rel="prefetch" href="/fastai/assets/js/24.720b52ea.js"><link rel="prefetch" href="/fastai/assets/js/25.7912d1b1.js"><link rel="prefetch" href="/fastai/assets/js/26.366239e0.js"><link rel="prefetch" href="/fastai/assets/js/27.6db2df9e.js"><link rel="prefetch" href="/fastai/assets/js/28.ffbcb114.js"><link rel="prefetch" href="/fastai/assets/js/29.7b21b9fd.js"><link rel="prefetch" href="/fastai/assets/js/3.6e2ab6c3.js"><link rel="prefetch" href="/fastai/assets/js/31.b22a56a0.js"><link rel="prefetch" href="/fastai/assets/js/32.85f7da41.js"><link rel="prefetch" href="/fastai/assets/js/33.e44ef8ee.js"><link rel="prefetch" href="/fastai/assets/js/34.9ce56e10.js"><link rel="prefetch" href="/fastai/assets/js/35.4bdc5816.js"><link rel="prefetch" href="/fastai/assets/js/36.67e5f7d9.js"><link rel="prefetch" href="/fastai/assets/js/37.36c20575.js"><link rel="prefetch" href="/fastai/assets/js/38.06c462ff.js"><link rel="prefetch" href="/fastai/assets/js/39.749b6672.js"><link rel="prefetch" href="/fastai/assets/js/4.a083dd6e.js"><link rel="prefetch" href="/fastai/assets/js/40.c732859b.js"><link rel="prefetch" href="/fastai/assets/js/41.4474ab47.js"><link rel="prefetch" href="/fastai/assets/js/42.5ee2fc2f.js"><link rel="prefetch" href="/fastai/assets/js/43.cc635513.js"><link rel="prefetch" href="/fastai/assets/js/44.152c8da5.js"><link rel="prefetch" href="/fastai/assets/js/45.4cff1d71.js"><link rel="prefetch" href="/fastai/assets/js/46.85dce95d.js"><link rel="prefetch" href="/fastai/assets/js/47.59fb5617.js"><link rel="prefetch" href="/fastai/assets/js/48.f20ef06e.js"><link rel="prefetch" href="/fastai/assets/js/49.9625880a.js"><link rel="prefetch" href="/fastai/assets/js/5.bb68e855.js"><link rel="prefetch" href="/fastai/assets/js/50.b2e6dee9.js"><link rel="prefetch" href="/fastai/assets/js/51.267442e2.js"><link rel="prefetch" href="/fastai/assets/js/52.10494ddd.js"><link rel="prefetch" href="/fastai/assets/js/53.093941a1.js"><link rel="prefetch" href="/fastai/assets/js/54.fbc03694.js"><link rel="prefetch" href="/fastai/assets/js/55.0b1efc19.js"><link rel="prefetch" href="/fastai/assets/js/56.5f3c1da5.js"><link rel="prefetch" href="/fastai/assets/js/57.a3e942a9.js"><link rel="prefetch" href="/fastai/assets/js/58.d3ded5e3.js"><link rel="prefetch" href="/fastai/assets/js/59.ec1d3156.js"><link rel="prefetch" href="/fastai/assets/js/6.f6c9602c.js"><link rel="prefetch" href="/fastai/assets/js/60.37aa0b8a.js"><link rel="prefetch" href="/fastai/assets/js/61.ef622343.js"><link rel="prefetch" href="/fastai/assets/js/62.e733d0f9.js"><link rel="prefetch" href="/fastai/assets/js/63.a3aa571a.js"><link rel="prefetch" href="/fastai/assets/js/64.8b06642f.js"><link rel="prefetch" href="/fastai/assets/js/65.97cf2dfa.js"><link rel="prefetch" href="/fastai/assets/js/66.7f97711c.js"><link rel="prefetch" href="/fastai/assets/js/67.31ee059f.js"><link rel="prefetch" href="/fastai/assets/js/68.d013d2de.js"><link rel="prefetch" href="/fastai/assets/js/69.50b9f11d.js"><link rel="prefetch" href="/fastai/assets/js/7.c1cdf251.js"><link rel="prefetch" href="/fastai/assets/js/70.1b6f8370.js"><link rel="prefetch" href="/fastai/assets/js/71.8c3557b5.js"><link rel="prefetch" href="/fastai/assets/js/72.2d857b7b.js"><link rel="prefetch" href="/fastai/assets/js/73.0be86c71.js"><link rel="prefetch" href="/fastai/assets/js/74.a9279ff6.js"><link rel="prefetch" href="/fastai/assets/js/75.f6ce5fb3.js"><link rel="prefetch" href="/fastai/assets/js/8.be08f3ee.js"><link rel="prefetch" href="/fastai/assets/js/9.209ff10c.js">
    <link rel="stylesheet" href="/fastai/assets/css/0.styles.24b54ae9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/fastai/" class="home-link router-link-active"><img src="https://images.exxactcorp.com/CMS/landing-page/resource-center/supported-software/logo/Deep-Learning/fastai-logo.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Getting Started" class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow down"></span></button> <button type="button" aria-label="Getting Started" class="mobile-dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/" class="nav-link">
  Overview
</a></li><li class="dropdown-item"><!----> <a href="/fastai/quick_start.html" class="nav-link">
  Quick Start
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tutorials" class="dropdown-title"><span class="title">Tutorials</span> <span class="arrow down"></span></button> <button type="button" aria-label="Tutorials" class="mobile-dropdown-title"><span class="title">Tutorials</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/overview.html" class="nav-link">
  Overview
</a></li><li class="dropdown-item"><h4>
          Beginners
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/fastai/tutorial/vision.html" class="nav-link">
  Vision Tutorial
</a></li><li class="dropdown-subitem"><a href="/fastai/tutorial/text.html" class="nav-link">
  Text Tutorial
</a></li><li class="dropdown-subitem"><a href="/fastai/tutorial/tabular.html" class="nav-link">
  Tabular Tutorial
</a></li><li class="dropdown-subitem"><a href="/fastai/tutorial/colab.html" class="nav-link">
  Colab Tutorial
</a></li></ul></li><li class="dropdown-item"><h4>
          Intermediate
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/fastai/tutorial/datablock.html" class="nav-link">
  Data Block Tutorial
</a></li><li class="dropdown-subitem"><a href="/fastai/tutorial/imagenette.html" class="nav-link">
  Imagenette Tutorial
</a></li><li class="dropdown-subitem"><a href="/fastai/tutorial/pets.html" class="nav-link">
  Pets Tutorial
</a></li><li class="dropdown-subitem"><a href="/fastai/tutorial/transformers.html" class="nav-link">
  Transformers Tutorial
</a></li><li class="dropdown-subitem"><a href="/fastai/tutorial/wikitext.html" class="nav-link">
  Wikitext Tutorial
</a></li></ul></li><li class="dropdown-item"><h4>
          Advanced
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/fastai/tutorial/siamese.html" class="nav-link">
  Siamese Tutorial
</a></li><li class="dropdown-subitem"><a href="/fastai/dev-setup.html" class="nav-link">
  Developer Guide
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Training" class="dropdown-title"><span class="title">Training</span> <span class="arrow down"></span></button> <button type="button" aria-label="Training" class="mobile-dropdown-title"><span class="title">Training</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/training/learner.html" class="nav-link">
  Training Loop
</a></li><li class="dropdown-item"><!----> <a href="/fastai/training/optimizer.html" class="nav-link">
  Optimizer
</a></li><li class="dropdown-item"><!----> <a href="/fastai/training/metrics.html" class="nav-link">
  Metrics
</a></li><li class="dropdown-item"><!----> <a href="/fastai/training/interpret.html" class="nav-link">
  Interpretation
</a></li><li class="dropdown-item"><!----> <a href="/fastai/training/distributed.html" class="nav-link">
  Distributed
</a></li><li class="dropdown-item"><h4>
          Callbacks
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/fastai/callback/core.html" class="nav-link">
  Core
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/schedule.html" class="nav-link">
  Schedulers
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/hook.html" class="nav-link">
  Hooks and callbacks
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/fp16.html" class="nav-link">
  Mixed precision
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/mixup.html" class="nav-link">
  Mixup
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/cutmix.html" class="nav-link">
  Cutmix
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/tracker.html" class="nav-link">
  Tracker
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/training.html" class="nav-link">
  Training
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/rnn.html" class="nav-link">
  RNN
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/data.html" class="nav-link">
  Data
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/progress.html" class="nav-link">
  Progress
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Data" class="dropdown-title"><span class="title">Data</span> <span class="arrow down"></span></button> <button type="button" aria-label="Data" class="mobile-dropdown-title"><span class="title">Data</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/data/block.html" class="nav-link">
  Data Blocks
</a></li><li class="dropdown-item"><!----> <a href="/fastai/data/transforms.html" class="nav-link">
  Data Transforms
</a></li><li class="dropdown-item"><!----> <a href="/fastai/data/external.html" class="nav-link">
  Data External
</a></li><li class="dropdown-item"><!----> <a href="/fastai/data/core.html" class="nav-link">
  Data Core
</a></li><li class="dropdown-item"><!----> <a href="/fastai/data/load.html" class="nav-link">
  DataLoaders
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Core" class="dropdown-title"><span class="title">Core</span> <span class="arrow down"></span></button> <button type="button" aria-label="Core" class="mobile-dropdown-title"><span class="title">Core</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/torch_core.html" class="nav-link">
  PyTorch Core
</a></li><li class="dropdown-item"><!----> <a href="/fastai/layers.html" class="nav-link">
  Layers
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vision" class="dropdown-title"><span class="title">Vision</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vision" class="mobile-dropdown-title"><span class="title">Vision</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/vision/learner.html" class="nav-link">
  Vision Learner
</a></li><li class="dropdown-item"><!----> <a href="/fastai/vision/augment.html" class="nav-link">
  Vision Data Augmentation
</a></li><li class="dropdown-item"><!----> <a href="/fastai/vision/data.html" class="nav-link">
  Vision Data
</a></li><li class="dropdown-item"><!----> <a href="/fastai/vision/core.html" class="nav-link">
  Vision Core
</a></li><li class="dropdown-item"><!----> <a href="/fastai/vision/utils.html" class="nav-link">
  Vision Utils
</a></li><li class="dropdown-item"><!----> <a href="/fastai/vision/widgets.html" class="nav-link">
  Vision Widgets
</a></li><li class="dropdown-item"><h4>
          Models
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/fastai/vision/models.xresnet.html" class="nav-link">
  XResNet
</a></li><li class="dropdown-subitem"><a href="/fastai/vision/models.unet.html" class="nav-link">
  UNet
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Text" class="dropdown-title"><span class="title">Text</span> <span class="arrow down"></span></button> <button type="button" aria-label="Text" class="mobile-dropdown-title"><span class="title">Text</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/text/core.html" class="nav-link">
  Text Core
</a></li><li class="dropdown-item"><!----> <a href="/fastai/text/data.html" class="nav-link">
  Text Data
</a></li><li class="dropdown-item"><!----> <a href="/fastai/text/learner.html" class="nav-link">
  Text Learner
</a></li><li class="dropdown-item"><h4>
          Models
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/fastai/text/models.core.html" class="nav-link">
  Core
</a></li><li class="dropdown-subitem"><a href="/fastai/text/models.awdlstm.html" class="nav-link">
  AWD LSTM
</a></li><li class="dropdown-subitem"><a href="/fastai/text/models.qrnn.html" class="nav-link">
  QRNN
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tabular" class="dropdown-title"><span class="title">Tabular</span> <span class="arrow down"></span></button> <button type="button" aria-label="Tabular" class="mobile-dropdown-title"><span class="title">Tabular</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/tabular/core.html" class="nav-link">
  Tabular Core
</a></li><li class="dropdown-item"><!----> <a href="/fastai/tabular/data.html" class="nav-link">
  Tabular Data
</a></li><li class="dropdown-item"><!----> <a href="/fastai/tabular/learner.html" class="nav-link">
  Tabular Learner
</a></li><li class="dropdown-item"><!----> <a href="/fastai/tabular/model.html" class="nav-link">
  Tabular Model
</a></li><li class="dropdown-item"><!----> <a href="/fastai/collab.html" class="nav-link">
  Collab
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Medical" class="dropdown-title"><span class="title">Medical</span> <span class="arrow down"></span></button> <button type="button" aria-label="Medical" class="mobile-dropdown-title"><span class="title">Medical</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/medical/imaging.html" class="nav-link">
  Medical imagery
</a></li><li class="dropdown-item"><!----> <a href="/fastai/medical/text.html" class="nav-link">
  Medical text
</a></li></ul></div></div> <a href="https://github.com/fastai/fastai" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Getting Started" class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow down"></span></button> <button type="button" aria-label="Getting Started" class="mobile-dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/" class="nav-link">
  Overview
</a></li><li class="dropdown-item"><!----> <a href="/fastai/quick_start.html" class="nav-link">
  Quick Start
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tutorials" class="dropdown-title"><span class="title">Tutorials</span> <span class="arrow down"></span></button> <button type="button" aria-label="Tutorials" class="mobile-dropdown-title"><span class="title">Tutorials</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/overview.html" class="nav-link">
  Overview
</a></li><li class="dropdown-item"><h4>
          Beginners
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/fastai/tutorial/vision.html" class="nav-link">
  Vision Tutorial
</a></li><li class="dropdown-subitem"><a href="/fastai/tutorial/text.html" class="nav-link">
  Text Tutorial
</a></li><li class="dropdown-subitem"><a href="/fastai/tutorial/tabular.html" class="nav-link">
  Tabular Tutorial
</a></li><li class="dropdown-subitem"><a href="/fastai/tutorial/colab.html" class="nav-link">
  Colab Tutorial
</a></li></ul></li><li class="dropdown-item"><h4>
          Intermediate
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/fastai/tutorial/datablock.html" class="nav-link">
  Data Block Tutorial
</a></li><li class="dropdown-subitem"><a href="/fastai/tutorial/imagenette.html" class="nav-link">
  Imagenette Tutorial
</a></li><li class="dropdown-subitem"><a href="/fastai/tutorial/pets.html" class="nav-link">
  Pets Tutorial
</a></li><li class="dropdown-subitem"><a href="/fastai/tutorial/transformers.html" class="nav-link">
  Transformers Tutorial
</a></li><li class="dropdown-subitem"><a href="/fastai/tutorial/wikitext.html" class="nav-link">
  Wikitext Tutorial
</a></li></ul></li><li class="dropdown-item"><h4>
          Advanced
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/fastai/tutorial/siamese.html" class="nav-link">
  Siamese Tutorial
</a></li><li class="dropdown-subitem"><a href="/fastai/dev-setup.html" class="nav-link">
  Developer Guide
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Training" class="dropdown-title"><span class="title">Training</span> <span class="arrow down"></span></button> <button type="button" aria-label="Training" class="mobile-dropdown-title"><span class="title">Training</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/training/learner.html" class="nav-link">
  Training Loop
</a></li><li class="dropdown-item"><!----> <a href="/fastai/training/optimizer.html" class="nav-link">
  Optimizer
</a></li><li class="dropdown-item"><!----> <a href="/fastai/training/metrics.html" class="nav-link">
  Metrics
</a></li><li class="dropdown-item"><!----> <a href="/fastai/training/interpret.html" class="nav-link">
  Interpretation
</a></li><li class="dropdown-item"><!----> <a href="/fastai/training/distributed.html" class="nav-link">
  Distributed
</a></li><li class="dropdown-item"><h4>
          Callbacks
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/fastai/callback/core.html" class="nav-link">
  Core
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/schedule.html" class="nav-link">
  Schedulers
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/hook.html" class="nav-link">
  Hooks and callbacks
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/fp16.html" class="nav-link">
  Mixed precision
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/mixup.html" class="nav-link">
  Mixup
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/cutmix.html" class="nav-link">
  Cutmix
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/tracker.html" class="nav-link">
  Tracker
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/training.html" class="nav-link">
  Training
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/rnn.html" class="nav-link">
  RNN
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/data.html" class="nav-link">
  Data
</a></li><li class="dropdown-subitem"><a href="/fastai/callback/progress.html" class="nav-link">
  Progress
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Data" class="dropdown-title"><span class="title">Data</span> <span class="arrow down"></span></button> <button type="button" aria-label="Data" class="mobile-dropdown-title"><span class="title">Data</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/data/block.html" class="nav-link">
  Data Blocks
</a></li><li class="dropdown-item"><!----> <a href="/fastai/data/transforms.html" class="nav-link">
  Data Transforms
</a></li><li class="dropdown-item"><!----> <a href="/fastai/data/external.html" class="nav-link">
  Data External
</a></li><li class="dropdown-item"><!----> <a href="/fastai/data/core.html" class="nav-link">
  Data Core
</a></li><li class="dropdown-item"><!----> <a href="/fastai/data/load.html" class="nav-link">
  DataLoaders
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Core" class="dropdown-title"><span class="title">Core</span> <span class="arrow down"></span></button> <button type="button" aria-label="Core" class="mobile-dropdown-title"><span class="title">Core</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/torch_core.html" class="nav-link">
  PyTorch Core
</a></li><li class="dropdown-item"><!----> <a href="/fastai/layers.html" class="nav-link">
  Layers
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vision" class="dropdown-title"><span class="title">Vision</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vision" class="mobile-dropdown-title"><span class="title">Vision</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/vision/learner.html" class="nav-link">
  Vision Learner
</a></li><li class="dropdown-item"><!----> <a href="/fastai/vision/augment.html" class="nav-link">
  Vision Data Augmentation
</a></li><li class="dropdown-item"><!----> <a href="/fastai/vision/data.html" class="nav-link">
  Vision Data
</a></li><li class="dropdown-item"><!----> <a href="/fastai/vision/core.html" class="nav-link">
  Vision Core
</a></li><li class="dropdown-item"><!----> <a href="/fastai/vision/utils.html" class="nav-link">
  Vision Utils
</a></li><li class="dropdown-item"><!----> <a href="/fastai/vision/widgets.html" class="nav-link">
  Vision Widgets
</a></li><li class="dropdown-item"><h4>
          Models
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/fastai/vision/models.xresnet.html" class="nav-link">
  XResNet
</a></li><li class="dropdown-subitem"><a href="/fastai/vision/models.unet.html" class="nav-link">
  UNet
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Text" class="dropdown-title"><span class="title">Text</span> <span class="arrow down"></span></button> <button type="button" aria-label="Text" class="mobile-dropdown-title"><span class="title">Text</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/text/core.html" class="nav-link">
  Text Core
</a></li><li class="dropdown-item"><!----> <a href="/fastai/text/data.html" class="nav-link">
  Text Data
</a></li><li class="dropdown-item"><!----> <a href="/fastai/text/learner.html" class="nav-link">
  Text Learner
</a></li><li class="dropdown-item"><h4>
          Models
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/fastai/text/models.core.html" class="nav-link">
  Core
</a></li><li class="dropdown-subitem"><a href="/fastai/text/models.awdlstm.html" class="nav-link">
  AWD LSTM
</a></li><li class="dropdown-subitem"><a href="/fastai/text/models.qrnn.html" class="nav-link">
  QRNN
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tabular" class="dropdown-title"><span class="title">Tabular</span> <span class="arrow down"></span></button> <button type="button" aria-label="Tabular" class="mobile-dropdown-title"><span class="title">Tabular</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/tabular/core.html" class="nav-link">
  Tabular Core
</a></li><li class="dropdown-item"><!----> <a href="/fastai/tabular/data.html" class="nav-link">
  Tabular Data
</a></li><li class="dropdown-item"><!----> <a href="/fastai/tabular/learner.html" class="nav-link">
  Tabular Learner
</a></li><li class="dropdown-item"><!----> <a href="/fastai/tabular/model.html" class="nav-link">
  Tabular Model
</a></li><li class="dropdown-item"><!----> <a href="/fastai/collab.html" class="nav-link">
  Collab
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Medical" class="dropdown-title"><span class="title">Medical</span> <span class="arrow down"></span></button> <button type="button" aria-label="Medical" class="mobile-dropdown-title"><span class="title">Medical</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fastai/medical/imaging.html" class="nav-link">
  Medical imagery
</a></li><li class="dropdown-item"><!----> <a href="/fastai/medical/text.html" class="nav-link">
  Medical text
</a></li></ul></div></div> <a href="https://github.com/fastai/fastai" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Learner</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/fastai/learner.html#utils-function" class="sidebar-link">Utils function</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fastai/learner.html#pytorch-interop" class="sidebar-link">PyTorch interop</a></li><li class="sidebar-sub-header"><a href="/fastai/learner.html#training-loop" class="sidebar-link">Training loop</a></li><li class="sidebar-sub-header"><a href="/fastai/learner.html#serializing" class="sidebar-link">Serializing</a></li><li class="sidebar-sub-header"><a href="/fastai/learner.html#callback-handling" class="sidebar-link">Callback handling</a></li><li class="sidebar-sub-header"><a href="/fastai/learner.html#internals" class="sidebar-link">Internals</a></li><li class="sidebar-sub-header"><a href="/fastai/learner.html#plotting-tools" class="sidebar-link">Plotting tools</a></li></ul></li><li><a href="/fastai/learner.html#inference-functions" class="sidebar-link">Inference functions</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/fastai/learner.html#transfer-learning" class="sidebar-link">Transfer learning</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fastai/learner.html#exporting-a-learner" class="sidebar-link">Exporting a Learner</a></li></ul></li><li><a href="/fastai/learner.html#tta" class="sidebar-link">TTA</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/fastai/learner.html#gather-arguments" class="sidebar-link">Gather arguments</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="learner"><a href="#learner" class="header-anchor">#</a> Learner</h1> <blockquote><p>Basic class for handling the training loop</p></blockquote> <p>You probably want to jump directly to the definition of <a href="/fastai/learner.html#Learner"><code>Learner</code></a>.</p> <h2 id="utils-function"><a href="#utils-function" class="header-anchor">#</a> Utils function</h2> <h4 id="replacing_yield" class="doc_header"><code>replacing_yield</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L29" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>replacing_yield</code>(<strong><code>o</code></strong>, <strong><code>attr</code></strong>, <strong><code>val</code></strong>)</p></blockquote> <p>Context manager to temporarily replace an attribute</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">_A</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>a <span class="token operator">=</span> a
    <span class="token decorator annotation punctuation">@contextmanager</span>
    <span class="token keyword">def</span> <span class="token function">a_changed</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">return</span> replacing_yield<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> v<span class="token punctuation">)</span>

a <span class="token operator">=</span> _A<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> a<span class="token punctuation">.</span>a_changed<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    test_eq<span class="token punctuation">(</span>a<span class="token punctuation">.</span>a<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span>a<span class="token punctuation">.</span>a<span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="mk_metric" class="doc_header"><code>mk_metric</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L36" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>mk_metric</code>(<strong><code>m</code></strong>)</p></blockquote> <p>Convert <code>m</code> to an <a href="/fastai/learner.html#AvgMetric"><code>AvgMetric</code></a>, unless it's already a <a href="/fastai/learner.html#Metric"><code>Metric</code></a></p> <p>See the class <a href="/fastai/learner.html#Metric"><code>Metric</code></a> below for more information.</p> <h4 id="save_model" class="doc_header"><code>save_model</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L41" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>save_model</code>(<strong><code>file</code></strong>, <strong><code>model</code></strong>, <strong><code>opt</code></strong>, <strong><code>with_opt</code></strong>=<em><code>True</code></em>, <strong><code>pickle_protocol</code></strong>=<em><code>2</code></em>)</p></blockquote> <p>Save <code>model</code> to <code>file</code> along with <code>opt</code> (if available, and if <code>with_opt</code>)</p> <p><code>file</code> can be a <code>Path</code> object, a string or an opened file object. <code>pickle_protocol</code> is passed along to <code>torch.save</code></p> <h4 id="load_model" class="doc_header"><code>load_model</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L50" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>load_model</code>(<strong><code>file</code></strong>, <strong><code>model</code></strong>, <strong><code>opt</code></strong>, <strong><code>with_opt</code></strong>=<em><code>None</code></em>, <strong><code>device</code></strong>=<em><code>None</code></em>, <strong><code>strict</code></strong>=<em><code>True</code></em>)</p></blockquote> <p>Load <code>model</code> from <code>file</code> along with <code>opt</code> (if available, and if <code>with_opt</code>)</p> <p><code>file</code> can be a <code>Path</code> object, a string or an opened file object. If a <code>device</code> is passed, the model is loaded on it, otherwise it's loaded on the CPU.</p> <p>If <code>strict</code> is <code>True</code>, the file must exactly contain weights for every parameter key in <code>model</code>, if <code>strict</code> is <code>False</code>, only the keys that are in the saved model are loaded in <code>model</code>.</p> <h2 id="Learner" class="doc_header"><code>class</code> <code>Learner</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L82" class="source_link" style="float:right;">[source]</a></h2> <blockquote><p><code>Learner</code>(<strong><code>dls</code></strong>, <strong><code>model</code></strong>, <strong><code>loss_func</code></strong>=<em><code>None</code></em>, <strong><code>opt_func</code></strong>=<em><code>Adam</code></em>, <strong><code>lr</code></strong>=<em><code>0.001</code></em>, <strong><code>splitter</code></strong>=<em><code>trainable_params</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>metrics</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>model_dir</code></strong>=<em><code>'models'</code></em>, <strong><code>wd</code></strong>=<em><code>None</code></em>, <strong><code>wd_bn_bias</code></strong>=<em><code>False</code></em>, <strong><code>train_bn</code></strong>=<em><code>True</code></em>, <strong><code>moms</code></strong>=<em><code>(0.95, 0.85, 0.95)</code></em>)</p></blockquote> <p>Group together a <code>model</code>, some <code>dls</code> and a <code>loss_func</code> to handle training</p> <p><code>opt_func</code> will be used to create an optimizer when <a href="/fastai/learner.html#Learner.fit"><code>Learner.fit</code></a> is called, with <code>lr</code> as a default learning rate. <code>splitter</code> is a function that takes <code>self.model</code> and returns a list of parameter groups (or just one parameter group if there are no different parameter groups). The default is <a href="/fastai/torch_core.html#trainable_params"><code>trainable_params</code></a>, which returns all trainable parameters of the model.</p> <p><code>cbs</code> is one or a list of <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a>s  to pass to the <a href="/fastai/learner.html#Learner"><code>Learner</code></a>. <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a>s are used for every tweak of the training loop. Each <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a> is registered as an attribute of <a href="/fastai/learner.html#Learner"><code>Learner</code></a> (with camel case). At creation, all the callbacks in <a href="https://fastcore.fast.ai/foundation#defaults.callbacks" target="_blank" rel="noopener noreferrer"><code>defaults.callbacks</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (<a href="/fastai/callback.core.html#TrainEvalCallback"><code>TrainEvalCallback</code></a>, <a href="/fastai/learner.html#Recorder"><code>Recorder</code></a> and <a href="/fastai/callback.progress.html#ProgressCallback"><code>ProgressCallback</code></a>) are associated to the <a href="/fastai/learner.html#Learner"><code>Learner</code></a>.</p> <p><a href="/fastai/metrics.html"><code>metrics</code></a> is an optional list of metrics, that can be either functions or <a href="/fastai/learner.html#Metric"><code>Metric</code></a>s (see below).</p> <p><code>path</code> and <code>model_dir</code> are used to save and/or load models. Often <code>path</code> will be inferred from <code>dls</code>, but you can override it or pass a <code>Path</code>  object to <code>model_dir</code>. Make sure you can write in <code>path/model_dir</code>!</p> <p><code>wd</code> is the default weight decay used when training the model; <code>moms</code>, the default momentums used in <a href="/fastai/callback.schedule.html#Learner.fit_one_cycle"><code>Learner.fit_one_cycle</code></a>. <code>wd_bn_bias</code> controls if weight decay is applied to <a href="/fastai/layers.html#BatchNorm"><code>BatchNorm</code></a> layers and bias.</p> <p>Lastly, <code>train_bn</code> controls if <a href="/fastai/layers.html#BatchNorm"><code>BatchNorm</code></a> layers are trained even when they are supposed to be frozen according to the <code>splitter</code>. Our empirical experiments have shown that it's the best behavior for those layers in transfer learning.</p> <h3 id="pytorch-interop"><a href="#pytorch-interop" class="header-anchor">#</a> PyTorch interop</h3> <p>You can use regular PyTorch functionality for most of the arguments of the <a href="/fastai/learner.html#Learner"><code>Learner</code></a>, although the experience will be smoother with pure fastai objects and you will be able to use the full functionality of the library. The expectation is that the training loop will work smoothly even if you did not use fastai end to end. What you might lose are interpretation objects or showing functionality. The list below explains how to use plain PyTorch objects for all the arguments and what you might lose.</p> <p>The most important is <code>opt_func</code>. If you are not using a fastai optimizer, you will need to write a function that wraps your PyTorch optimizer in an <a href="/fastai/optimizer.html#OptimWrapper"><code>OptimWrapper</code></a>. See the <a href="http://docs.fast.ai/optimizer" target="_blank" rel="noopener noreferrer">optimizer module<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for more details. This is to ensure the library's schedulers/freeze API work with your code.</p> <ul><li><code>dls</code> is a <a href="/fastai/data.core.html#DataLoaders"><code>DataLoaders</code></a> object, that you can create from standard PyTorch dataloaders. By doing so, you will lose all showing functionality like <code>show_batch</code>/<code>show_results</code>. You can check the <a href="http://docs.fast.ai/tutorial.datablock" target="_blank" rel="noopener noreferrer">data block API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or the <a href="http://docs.fast.ai/tutorial.pets" target="_blank" rel="noopener noreferrer">mid-level data API tutorial<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to learn how to use fastai to gather your data!</li> <li><code>model</code> is a standard PyTorch model. You can use anyone you like, just make sure it accepts the number of inputs you have in your <a href="/fastai/data.core.html#DataLoaders"><code>DataLoaders</code></a> and returns as many outputs as you have targets.</li> <li><code>loss_func</code> can be any loss function you like. It needs to be one of fastai's if you want to use <code>Learn.predict</code> or <code>Learn.get_preds</code>, or you will have to implement special methods (see more details after the <a href="/fastai/layers.html#BaseLoss"><code>BaseLoss</code></a> documentation).</li></ul> <p>Now let's look at the main thing the <a href="/fastai/learner.html#Learner"><code>Learner</code></a> class implements: the training loop.</p> <h3 id="training-loop"><a href="#training-loop" class="header-anchor">#</a> Training loop</h3> <h4 id="Learner.fit" class="doc_header"><code>Learner.fit</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L196" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.fit</code>(<strong><code>n_epoch</code></strong>, <strong><code>lr</code></strong>=<em><code>None</code></em>, <strong><code>wd</code></strong>=<em><code>None</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>reset_opt</code></strong>=<em><code>False</code></em>)</p></blockquote> <p>Fit <code>self.model</code> for <code>n_epoch</code> using <code>cbs</code>. Optionally <code>reset_opt</code>.</p> <p>Uses <code>lr</code> and <code>wd</code> if they are provided, otherwise use the defaults values given by the <code>lr</code> and <code>wd</code> attributes of <a href="/fastai/learner.html#Learner"><code>Learner</code></a>.</p> <p>All the examples use <a href="/fastai/test_utils.html#synth_learner"><code>synth_learner</code></a> which is a simple <a href="/fastai/learner.html#Learner"><code>Learner</code></a> training a linear regression model.</p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span>lr<span class="token operator">=</span><span class="token number">5e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>model <span class="token operator">=</span> learn<span class="token punctuation">.</span>model<span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span>
xb<span class="token punctuation">,</span>yb <span class="token operator">=</span> learn<span class="token punctuation">.</span>dls<span class="token punctuation">.</span>one_batch<span class="token punctuation">(</span><span class="token punctuation">)</span>
init_loss <span class="token operator">=</span> learn<span class="token punctuation">.</span>loss_func<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>model<span class="token punctuation">(</span>xb<span class="token punctuation">)</span><span class="token punctuation">,</span> yb<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
xb<span class="token punctuation">,</span>yb <span class="token operator">=</span> learn<span class="token punctuation">.</span>dls<span class="token punctuation">.</span>one_batch<span class="token punctuation">(</span><span class="token punctuation">)</span>
final_loss <span class="token operator">=</span> learn<span class="token punctuation">.</span>loss_func<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>model<span class="token punctuation">(</span>xb<span class="token punctuation">)</span><span class="token punctuation">,</span> yb<span class="token punctuation">)</span>
<span class="token keyword">assert</span> final_loss <span class="token operator">&lt;</span> init_loss
</code></pre></div><h4 id="Learner.one_batch" class="doc_header"><code>Learner.one_batch</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L173" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.one_batch</code>(<strong><code>i</code></strong>, <strong><code>b</code></strong>)</p></blockquote> <p>Train or evaluate <code>self.model</code> on batch <code>(xb,yb)</code></p> <p>This is an internal method called by <a href="/fastai/learner.html#Learner.fit"><code>Learner.fit</code></a>. If passed, <code>i</code> is the index of this iteration in the epoch. In training mode, this does a full training step on the batch (compute predictions, loss, gradients, update the model parameters and zero the gradients). In validation mode, it stops at the loss computation. Training or validation is controlled internally by the <a href="/fastai/callback.core.html#TrainEvalCallback"><code>TrainEvalCallback</code></a> through the <code>training</code> attribute.</p> <p>Nothing is returned, but the attributes <code>x</code>, <code>y</code>, <code>pred</code>, <code>loss</code> of the <a href="/fastai/learner.html#Learner"><code>Learner</code></a> are set with the proper values:</p> <div class="language-python extra-class"><pre class="language-python"><code>b <span class="token operator">=</span> learn<span class="token punctuation">.</span>dls<span class="token punctuation">.</span>one_batch<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>one_batch<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>x<span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>y<span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
out <span class="token operator">=</span> learn<span class="token punctuation">.</span>model<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>x<span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>pred<span class="token punctuation">,</span> out<span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>loss<span class="token punctuation">,</span> learn<span class="token punctuation">.</span>loss_func<span class="token punctuation">(</span>out<span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>More generally, the following attributes of <a href="/fastai/learner.html#Learner"><code>Learner</code></a> are available and updated during the training loop:</p> <ul><li><code>model</code>: the model used for training/validation</li> <li><code>data</code>: the underlying <a href="/fastai/data.core.html#DataLoaders"><code>DataLoaders</code></a></li> <li><code>loss_func</code>: the loss function used</li> <li><code>opt</code>: the optimizer used to update the model parameters</li> <li><code>opt_func</code>: the function used to create the optimizer</li> <li><code>cbs</code>: the list containing all <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a>s</li> <li><code>dl</code>: current <a href="/fastai/data.load.html#DataLoader"><code>DataLoader</code></a> used for iteration</li> <li><code>x</code>/<code>xb</code>: last input drawn from <code>self.dl</code> (potentially modified by callbacks). <code>xb</code> is always a tuple (potentially with one element) and <code>x</code> is detuplified. You can only assign to <code>xb</code>.</li> <li><code>y</code>/<code>yb</code>: last target drawn from <code>self.dl</code> (potentially modified by callbacks). <code>yb</code> is always a tuple (potentially with one element) and <code>y</code> is detuplified. You can only assign to <code>yb</code>.</li> <li><code>pred</code>: last predictions from <code>self.model</code> (potentially modified by callbacks)</li> <li><code>loss</code>: last computed loss (potentially modified by callbacks)</li> <li><code>n_epoch</code>: the number of epochs in this training</li> <li><code>n_iter</code>: the number of iterations in the current <code>self.dl</code></li> <li><code>epoch</code>: the current epoch index (from 0 to <code>n_epoch-1</code>)</li> <li><code>iter</code>: the current iteration index in <code>self.dl</code> (from 0 to <code>n_iter-1</code>)</li></ul> <p>The following attributes are added by <a href="/fastai/callback.core.html#TrainEvalCallback"><code>TrainEvalCallback</code></a> and should be available unless you went out of your way to remove that callback:</p> <ul><li><code>train_iter</code>: the number of training iterations done since the beginning of this training</li> <li><code>pct_train</code>: from 0. to 1., the percentage of training iterations completed</li> <li><code>training</code>:  flag to indicate if we're in training mode or not</li></ul> <p>The following attribute is added by <a href="/fastai/learner.html#Recorder"><code>Recorder</code></a> and should be available unless you went out of your way to remove that callback:</p> <ul><li><code>smooth_loss</code>: an exponentially-averaged version of the training loss</li></ul> <h4 id="Learner.all_batches" class="doc_header"><code>Learner.all_batches</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L159" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.all_batches</code>()</p></blockquote> <p>Train or evaluate <code>self.model</code> on all the batches of <code>self.dl</code></p> <h4 id="Learner.create_opt" class="doc_header"><code>Learner.create_opt</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L140" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.create_opt</code>()</p></blockquote> <p>Create an optimizer with default hyper-parameters</p> <p>This method is called internally to create the optimizer, the hyper-parameters are then adjusted by what you pass to <a href="/fastai/learner.html#Learner.fit"><code>Learner.fit</code></a> or your particular schedulers (see <a href="/fastai/callback.schedule.html"><code>callback.schedule</code></a>).</p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span>n_train<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> cbs<span class="token operator">=</span>VerboseCallback<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> learn<span class="token punctuation">.</span>opt <span class="token keyword">is</span> <span class="token boolean">None</span>
learn<span class="token punctuation">.</span>create_opt<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> learn<span class="token punctuation">.</span>opt <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span>
test_eq<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>hypers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'lr'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> learn<span class="token punctuation">.</span>lr<span class="token punctuation">)</span>
</code></pre></div><h3 id="serializing"><a href="#serializing" class="header-anchor">#</a> Serializing</h3> <h4 id="Learner.save" class="doc_header"><code>Learner.save</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L277" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.save</code>(<strong><code>file</code></strong>, <strong><code>with_opt</code></strong>=<em><code>True</code></em>, <strong><code>pickle_protocol</code></strong>=<em><code>2</code></em>)</p></blockquote> <p>Save model and optimizer state (if <code>with_opt</code>) to <code>self.path/self.model_dir/file</code></p> <p><code>file</code> can be a <code>Path</code>, a <code>string</code> or a buffer. <code>pickle_protocol</code> is passed along to <code>torch.save</code>.</p> <h4 id="Learner.load" class="doc_header"><code>Learner.load</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L283" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.load</code>(<strong><code>file</code></strong>, <strong><code>with_opt</code></strong>=<em><code>None</code></em>, <strong><code>device</code></strong>=<em><code>None</code></em>, <strong><code>strict</code></strong>=<em><code>True</code></em>)</p></blockquote> <p>Load model and optimizer state (if <code>with_opt</code>) from <code>self.path/self.model_dir/file</code> using <code>device</code></p> <p><code>file</code> can be a <code>Path</code>, a <code>string</code> or a buffer. Use <code>device</code> to load the model/optimizer state on a device different from the one it was saved.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">with</span> tempfile<span class="token punctuation">.</span>TemporaryDirectory<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> d<span class="token punctuation">:</span>
    learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span>path<span class="token operator">=</span>d<span class="token punctuation">)</span>
    learn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    
    <span class="token comment">#Test save created a file</span>
    learn<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'tmp'</span><span class="token punctuation">)</span>
    <span class="token keyword">assert</span> <span class="token punctuation">(</span>Path<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token operator">/</span><span class="token string">'models/tmp.pth'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment">#Test load did load the model</span>
    learn1 <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span>path<span class="token operator">=</span>d<span class="token punctuation">)</span>
    learn1 <span class="token operator">=</span> learn1<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">'tmp'</span><span class="token punctuation">)</span>
    test_eq<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>model<span class="token punctuation">.</span>a<span class="token punctuation">,</span> learn1<span class="token punctuation">.</span>model<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
    test_eq<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>model<span class="token punctuation">.</span>b<span class="token punctuation">,</span> learn1<span class="token punctuation">.</span>model<span class="token punctuation">.</span>b<span class="token punctuation">)</span>
    test_eq<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> learn1<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="callback-handling"><a href="#callback-handling" class="header-anchor">#</a> Callback handling</h3> <p>We only describe the basic functionality linked to <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a>s here. To learn more about <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a>s an how to write them, check the <a href="http://docs.fast.ai/callback.core" target="_blank" rel="noopener noreferrer">callback.core<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> module documentation.</p> <p>Let's first see how the <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a>s become attributes of <a href="/fastai/learner.html#Learner"><code>Learner</code></a>:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">TstCallback</span><span class="token punctuation">(</span>Callback<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">batch_begin</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>learn<span class="token punctuation">.</span>a <span class="token operator">=</span> self<span class="token punctuation">.</span>a <span class="token operator">+</span> <span class="token number">1</span>

tst_learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span><span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tst_learn<span class="token punctuation">.</span>cbs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>tst_learn<span class="token punctuation">.</span>cbs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> TrainEvalCallback<span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>tst_learn<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'train_eval'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

tst_learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span>cbs<span class="token operator">=</span>TstCallback<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tst_learn<span class="token punctuation">.</span>cbs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>tst_learn<span class="token punctuation">.</span>cbs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> TstCallback<span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>tst_learn<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'tst'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>A name that becomes an existing attribute of the <a href="/fastai/learner.html#Learner"><code>Learner</code></a> will throw an exception (here add_cb is a method of <a href="/fastai/learner.html#Learner"><code>Learner</code></a>).</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">AddCbCallback</span><span class="token punctuation">(</span>Callback<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">pass</span>
test_fail<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> synth_learner<span class="token punctuation">(</span>cbs<span class="token operator">=</span>AddCbCallback<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="Learner.__call__" class="doc_header"><code>Learner.__call__</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L133" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.<strong>call</strong></code>(<strong><code>event_name</code></strong>)</p></blockquote> <p>Call <code>event_name</code> for all <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a>s in <code>self.cbs</code></p> <p>This how the <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a>s are called internally. For instance a <a href="/fastai/test_utils.html#VerboseCallback"><code>VerboseCallback</code></a> just prints the event names (can be useful for debugging):</p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span>cbs<span class="token operator">=</span>VerboseCallback<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
learn<span class="token punctuation">(</span><span class="token string">'after_fit'</span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>after_fit
</code></pre></div><h4 id="Learner.add_cb" class="doc_header"><code>Learner.add_cb</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L104" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.add_cb</code>(<strong><code>cb</code></strong>)</p></blockquote> <p>Add <code>cb</code> to the list of <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a> and register <code>self</code> as their learner</p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>add_cb<span class="token punctuation">(</span>TestTrainEvalCallback<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>cbs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>cbs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> TestTrainEvalCallback<span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>train_eval<span class="token punctuation">.</span>learn<span class="token punctuation">,</span> learn<span class="token punctuation">)</span>
</code></pre></div><h4 id="Learner.add_cbs" class="doc_header"><code>Learner.add_cbs</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L102" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.add_cbs</code>(<strong><code>cbs</code></strong>)</p></blockquote> <p>Add <code>cbs</code> to the list of <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a> and register <code>self</code> as their learner</p> <div class="language-python extra-class"><pre class="language-python"><code>learn<span class="token punctuation">.</span>add_cbs<span class="token punctuation">(</span><span class="token punctuation">[</span>TestTrainEvalCallback<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> TestTrainEvalCallback<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>cbs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="Learner.added_cbs" class="doc_header"><code>Learner.added_cbs</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L119" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.added_cbs</code>(<strong><code>cbs</code></strong>)</p></blockquote> <p>Context manage that temporarily adds <code>cbs</code></p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span><span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>cbs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> learn<span class="token punctuation">.</span>added_cbs<span class="token punctuation">(</span>TestTrainEvalCallback<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    test_eq<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>cbs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="Learner.ordered_cbs" class="doc_header"><code>Learner.ordered_cbs</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L131" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.ordered_cbs</code>(<strong><code>event</code></strong>)</p></blockquote> <p>List of <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a>s, in order, for an <code>event</code> in the training loop</p> <p>By order, we mean using the internal ordering of the <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a>s (see <a href="/fastai/callback.core.html"><code>callback.core</code></a> for more information on how it works).</p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>add_cb<span class="token punctuation">(</span>TestTrainEvalCallback<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>ordered_cbs<span class="token punctuation">(</span><span class="token string">'before_fit'</span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>[TrainEvalCallback, TestTrainEvalCallback]
</code></pre></div><h4 id="Learner.remove_cb" class="doc_header"><code>Learner.remove_cb</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L112" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.remove_cb</code>(<strong><code>cb</code></strong>)</p></blockquote> <p>Add <code>cb</code> from the list of <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a> and deregister <code>self</code> as their learner</p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>add_cb<span class="token punctuation">(</span>TestTrainEvalCallback<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
cb <span class="token operator">=</span> learn<span class="token punctuation">.</span>cbs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
learn<span class="token punctuation">.</span>remove_cb<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>cbs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>cbs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> cb<span class="token punctuation">.</span>learn <span class="token keyword">is</span> <span class="token boolean">None</span>
<span class="token keyword">assert</span> <span class="token keyword">not</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>learn<span class="token punctuation">,</span><span class="token string">'test_train_eval'</span><span class="token punctuation">,</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</code></pre></div><p><code>cb</code> can simply be the class of the <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a> we want to remove (in which case all instances of that callback are removed).</p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>add_cbs<span class="token punctuation">(</span><span class="token punctuation">[</span>TestTrainEvalCallback<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> TestTrainEvalCallback<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>remove_cb<span class="token punctuation">(</span>TestTrainEvalCallback<span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>cbs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token keyword">not</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>learn<span class="token punctuation">,</span><span class="token string">'test_train_eval'</span><span class="token punctuation">,</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="Learner.remove_cbs" class="doc_header"><code>Learner.remove_cbs</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L103" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.remove_cbs</code>(<strong><code>cbs</code></strong>)</p></blockquote> <p>Remove <code>cbs</code> from the list of <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a> and deregister <code>self</code> as their learner</p> <p>Elements of <code>cbs</code> can either be types of callbacks or actual callbacks of the <a href="/fastai/learner.html#Learner"><code>Learner</code></a>.</p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>add_cbs<span class="token punctuation">(</span><span class="token punctuation">[</span>TestTrainEvalCallback<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
cb <span class="token operator">=</span> learn<span class="token punctuation">.</span>cbs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
learn<span class="token punctuation">.</span>remove_cbs<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>cbs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>cbs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="Learner.removed_cbs" class="doc_header"><code>Learner.removed_cbs</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L125" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.removed_cbs</code>(<strong><code>cbs</code></strong>)</p></blockquote> <p>Context manage that temporarily removes <code>cbs</code></p> <p>Elements of <code>cbs</code> can either be types of callbacks or actual callbacks of the <a href="/fastai/learner.html#Learner"><code>Learner</code></a>.</p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>add_cb<span class="token punctuation">(</span>TestTrainEvalCallback<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> learn<span class="token punctuation">.</span>removed_cbs<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>cbs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    test_eq<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>cbs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>learn<span class="token punctuation">.</span>cbs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="Learner.show_training_loop" class="doc_header"><code>Learner.show_training_loop</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L260" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.show_training_loop</code>()</p></blockquote> <p>Show each step in the training loop</p> <p>At each step, callbacks are shown in order, which can help debugging.</p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>show_training_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre><code>Start Fit
   - before_fit     : [TrainEvalCallback]
  Start Epoch Loop
     - before_epoch   : []
    Start Train
       - before_train   : [TrainEvalCallback]
      Start Batch Loop
         - before_batch   : []
         - after_pred     : []
         - after_loss     : []
         - before_backward: []
         - after_backward : []
         - after_step     : []
         - after_cancel_batch: []
         - after_batch    : [TrainEvalCallback]
      End Batch Loop
    End Train
     - after_cancel_train: []
     - after_train    : []
    Start Valid
       - before_validate: [TrainEvalCallback]
      Start Batch Loop
         - **CBs same as train batch**: []
      End Batch Loop
    End Valid
     - after_cancel_validate: []
     - after_validate : []
  End Epoch Loop
   - after_cancel_epoch: []
   - after_epoch    : []
End Fit
 - after_cancel_fit: []
 - after_fit      : []
</code></pre></div><h4 id="before_batch_cb" class="doc_header"><code>before_batch_cb</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L326" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>before_batch_cb</code>(<strong><code>f</code></strong>)</p></blockquote> <p>Shortcut for creating a Callback on the <code>before_batch</code> event, which takes and returns <code>xb,yb</code></p> <p>In order to change the data passed to your model, you will generally want to hook into the <code>before_batch</code> event, like so:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">TstCallback</span><span class="token punctuation">(</span>Callback<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">before_batch</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>learn<span class="token punctuation">.</span>xb <span class="token operator">=</span> self<span class="token punctuation">.</span>xb <span class="token operator">+</span> <span class="token number">1000</span>
        self<span class="token punctuation">.</span>learn<span class="token punctuation">.</span>yb <span class="token operator">=</span> self<span class="token punctuation">.</span>yb <span class="token operator">-</span> <span class="token number">1000</span>
</code></pre></div><p>Since that is so common, we provide the <a href="/fastai/learner.html#before_batch_cb"><code>before_batch_cb</code></a> decorator to make it easier.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@before_batch_cb</span>
<span class="token keyword">def</span> <span class="token function">cb</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> xb<span class="token punctuation">,</span> yb<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">return</span> xb<span class="token operator">+</span><span class="token number">1000</span><span class="token punctuation">,</span>yb<span class="token operator">-</span><span class="token number">1000</span>
</code></pre></div><h3 id="Metric" class="doc_header"><code>class</code> <code>Metric</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L332" class="source_link" style="float:right;">[source]</a></h3> <blockquote><p><code>Metric</code>()</p></blockquote> <p>Blueprint for defining a metric</p> <p>Metrics can be simple averages (like accuracy) but sometimes their computation is a little bit more complex and can't be averaged over batches (like precision or recall), which is why we need a special class for them. For simple functions that can be computed as averages over batches, we can use the class <a href="/fastai/learner.html#AvgMetric"><code>AvgMetric</code></a>, otherwise you'll need to implement the following methods.
{% include note.html content='If your <code>Metric</code> has state depending on tensors, don’t forget to store it on the CPU to avoid any potential memory leaks.' %}</p> <h4 id="Metric.reset" class="doc_header"><code>Metric.reset</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L334" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Metric.reset</code>()</p></blockquote> <p>Reset inner state to prepare for new computation</p> <h4 id="Metric.accumulate" class="doc_header"><code>Metric.accumulate</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L335" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Metric.accumulate</code>(<strong><code>learn</code></strong>)</p></blockquote> <p>Use <code>learn</code> to update the state with new results</p> <h4 id="Metric.value" class="doc_header"><code>Metric.value</code><a href="" class="source_link" style="float:right;">[source]</a></h4> <p>The value of the metric</p> <h4 id="Metric.name" class="doc_header"><code>Metric.name</code><a href="" class="source_link" style="float:right;">[source]</a></h4> <p>Name of the <a href="/fastai/learner.html#Metric"><code>Metric</code></a>, camel-cased and with Metric removed</p> <h3 id="AvgMetric" class="doc_header"><code>class</code> <code>AvgMetric</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L357" class="source_link" style="float:right;">[source]</a></h3> <blockquote><p><code>AvgMetric</code>(<strong><code>func</code></strong>) :: <a href="/fastai/learner.html#Metric"><code>Metric</code></a></p></blockquote> <p>Average the values of <code>func</code> taking into account potential different batch sizes</p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span><span class="token punctuation">)</span>
tst <span class="token operator">=</span> AvgMetric<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> <span class="token punctuation">(</span>x<span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
t<span class="token punctuation">,</span>u <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
tst<span class="token punctuation">.</span>reset<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
    learn<span class="token punctuation">.</span>pred<span class="token punctuation">,</span>learn<span class="token punctuation">.</span>yb <span class="token operator">=</span> t<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span>u<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
    tst<span class="token punctuation">.</span>accumulate<span class="token punctuation">(</span>learn<span class="token punctuation">)</span>
test_close<span class="token punctuation">(</span>tst<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token punctuation">(</span>t<span class="token operator">-</span>u<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="AvgLoss" class="doc_header"><code>class</code> <code>AvgLoss</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L371" class="source_link" style="float:right;">[source]</a></h3> <blockquote><p><code>AvgLoss</code>() :: <a href="/fastai/learner.html#Metric"><code>Metric</code></a></p></blockquote> <p>Average the losses taking into account potential different batch sizes</p> <div class="language-python extra-class"><pre class="language-python"><code>tst <span class="token operator">=</span> AvgLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>
t <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
tst<span class="token punctuation">.</span>reset<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
    learn<span class="token punctuation">.</span>yb<span class="token punctuation">,</span>learn<span class="token punctuation">.</span>loss <span class="token operator">=</span> t<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span>t<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
    tst<span class="token punctuation">.</span>accumulate<span class="token punctuation">(</span>learn<span class="token punctuation">)</span>
test_close<span class="token punctuation">(</span>tst<span class="token punctuation">.</span>value<span class="token punctuation">,</span> t<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="AvgSmoothLoss" class="doc_header"><code>class</code> <code>AvgSmoothLoss</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L384" class="source_link" style="float:right;">[source]</a></h3> <blockquote><p><code>AvgSmoothLoss</code>(<strong><code>beta</code></strong>=<em><code>0.98</code></em>) :: <a href="/fastai/learner.html#Metric"><code>Metric</code></a></p></blockquote> <p>Smooth average of the losses (exponentially weighted with <code>beta</code>)</p> <div class="language-python extra-class"><pre class="language-python"><code>tst <span class="token operator">=</span> AvgSmoothLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>
t <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
tst<span class="token punctuation">.</span>reset<span class="token punctuation">(</span><span class="token punctuation">)</span>
val <span class="token operator">=</span> tensor<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
    learn<span class="token punctuation">.</span>loss <span class="token operator">=</span> t<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
    tst<span class="token punctuation">.</span>accumulate<span class="token punctuation">(</span>learn<span class="token punctuation">)</span>
    val <span class="token operator">=</span> val<span class="token operator">*</span><span class="token number">0.98</span> <span class="token operator">+</span> t<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">0.98</span><span class="token punctuation">)</span>
    test_close<span class="token punctuation">(</span>val<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">0.98</span><span class="token operator">**</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tst<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
</code></pre></div><h3 id="ValueMetric" class="doc_header"><code>class</code> <code>ValueMetric</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L395" class="source_link" style="float:right;">[source]</a></h3> <blockquote><p><code>ValueMetric</code>(<strong><code>func</code></strong>, <strong><code>metric_name</code></strong>=<em><code>None</code></em>) :: <a href="/fastai/learner.html#Metric"><code>Metric</code></a></p></blockquote> <p>Use to include a pre-calculated metric value (for insance calculated in a <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a>) and returned by <code>func</code></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">metric_value_fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token number">5e</span><span class="token operator">-</span><span class="token number">3</span>

vm <span class="token operator">=</span> ValueMetric<span class="token punctuation">(</span>metric_value_fn<span class="token punctuation">,</span> <span class="token string">'custom_value_metric'</span><span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span>vm<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token number">5e</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span>vm<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">'custom_value_metric'</span><span class="token punctuation">)</span>

vm <span class="token operator">=</span> ValueMetric<span class="token punctuation">(</span>metric_value_fn<span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span>vm<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">'metric_value_fn'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="Recorder" class="doc_header"><code>class</code> <code>Recorder</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L413" class="source_link" style="float:right;">[source]</a></h2> <blockquote><p><code>Recorder</code>(<strong><code>add_time</code></strong>=<em><code>True</code></em>, <strong><code>train_metrics</code></strong>=<em><code>False</code></em>, <strong><code>valid_metrics</code></strong>=<em><code>True</code></em>, <strong><code>beta</code></strong>=<em><code>0.98</code></em>) :: <a href="/fastai/callback.core.html#Callback"><code>Callback</code></a></p></blockquote> <p>Callback that registers statistics (lr, loss and metrics) during training</p> <p>By default, metrics are computed on the validation set only, although that can be changed by adjusting <code>train_metrics</code> and <code>valid_metrics</code>. <code>beta</code> is the weight used to compute the exponentially weighted average of the losses (which gives the <code>smooth_loss</code> attribute to <a href="/fastai/learner.html#Learner"><code>Learner</code></a>).</p> <p>The <code>logger</code> attribute of a <a href="/fastai/learner.html#Learner"><code>Learner</code></a> determines what happens to those metrics. By default, it just print them:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">tst_metric</span><span class="token punctuation">(</span>out<span class="token punctuation">,</span> targ<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">return</span> F<span class="token punctuation">.</span>mse_loss<span class="token punctuation">(</span>out<span class="token punctuation">,</span> targ<span class="token punctuation">)</span>
learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span>n_train<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> metrics<span class="token operator">=</span>tst_metric<span class="token punctuation">)</span>
pat <span class="token operator">=</span> <span class="token string">r&quot;[tensor\(\d.\d*\), tensor\(\d.\d*\), tensor\(\d.\d*\), 'dd:dd']&quot;</span>
test_stdout<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> learn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pat<span class="token punctuation">,</span> regex<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="internals"><a href="#internals" class="header-anchor">#</a> Internals</h3> <h4 id="Recorder.before_fit" class="doc_header"><code>Recorder.before_fit</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L421" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Recorder.before_fit</code>()</p></blockquote> <p>Prepare state for training</p> <h4 id="Recorder.before_epoch" class="doc_header"><code>Recorder.before_epoch</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L444" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Recorder.before_epoch</code>()</p></blockquote> <p>Set timer if <code>self.add_time=True</code></p> <h4 id="Recorder.before_validate" class="doc_header"><code>Recorder.before_validate</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L451" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Recorder.before_validate</code>()</p></blockquote> <p>Reset loss and metrics state</p> <h4 id="Recorder.after_batch" class="doc_header"><code>Recorder.after_batch</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L434" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Recorder.after_batch</code>()</p></blockquote> <p>Update all metrics and records lr and smooth loss in training</p> <h4 id="Recorder.after_epoch" class="doc_header"><code>Recorder.after_epoch</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L457" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Recorder.after_epoch</code>()</p></blockquote> <p>Store and log the loss/metric values</p> <h3 id="plotting-tools"><a href="#plotting-tools" class="header-anchor">#</a> Plotting tools</h3> <h4 id="Recorder.plot_loss" class="doc_header"><code>Recorder.plot_loss</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L475" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Recorder.plot_loss</code>(<strong><code>skip_start</code></strong>=<em><code>5</code></em>, <strong><code>with_valid</code></strong>=<em><code>True</code></em>)</p></blockquote> <p>Plot the losses from <code>skip_start</code> and onward</p> <h2 id="inference-functions"><a href="#inference-functions" class="header-anchor">#</a> Inference functions</h2> <h4 id="Learner.validate" class="doc_header"><code>Learner.validate</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L216" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.validate</code>(<strong><code>ds_idx</code></strong>=<em><code>1</code></em>, <strong><code>dl</code></strong>=<em><code>None</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>)</p></blockquote> <p>Validate on <code>dl</code> with potential new <code>cbs</code>.</p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span>n_train<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> metrics<span class="token operator">=</span>tst_metric<span class="token punctuation">)</span>
res <span class="token operator">=</span> learn<span class="token punctuation">.</span>validate<span class="token punctuation">(</span><span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
x<span class="token punctuation">,</span>y <span class="token operator">=</span> learn<span class="token punctuation">.</span>dls<span class="token punctuation">.</span>valid_ds<span class="token punctuation">.</span>tensors
test_close<span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> F<span class="token punctuation">.</span>mse_loss<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>model<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="Learner.get_preds" class="doc_header"><code>Learner.get_preds</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L221" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.get_preds</code>(<strong><code>ds_idx</code></strong>=<em><code>1</code></em>, <strong><code>dl</code></strong>=<em><code>None</code></em>, <strong><code>with_input</code></strong>=<em><code>False</code></em>, <strong><code>with_decoded</code></strong>=<em><code>False</code></em>, <strong><code>with_loss</code></strong>=<em><code>False</code></em>, <strong><code>act</code></strong>=<em><code>None</code></em>, <strong><code>inner</code></strong>=<em><code>False</code></em>, <strong><code>reorder</code></strong>=<em><code>True</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>save_preds</code></strong>=<em><code>None</code></em>, <strong><code>save_targs</code></strong>=<em><code>None</code></em>, <strong><code>concat_dim</code></strong>=<em><code>0</code></em>)</p></blockquote> <p>Get the predictions and targets on the <code>ds_idx</code>-th dbunchset or <code>dl</code>, optionally <code>with_input</code> and <code>with_loss</code></p> <p><code>with_decoded</code> will also return the decoded predictions using the <code>decodes</code> function of the loss function (if it exists). For instance, fastai's <code>CrossEntropyFlat</code> takes the argmax or predictions in its decodes.</p> <p>Depending on the <code>loss_func</code> attribute of <a href="/fastai/learner.html#Learner"><code>Learner</code></a>, an activation function will be picked automatically so that the predictions make sense. For instance if the loss is a case of cross-entropy, a softmax will be applied, or if the loss is binary cross entropy with logits, a sigmoid will be applied. If you want to make sure a certain activation function is applied, you can pass it with <code>act</code>.</p> <p><code>save_preds</code> and <code>save_targs</code> should be used when your predictions are too big to fit all in memory. Give a <code>Path</code> object that points to a folder where the predictions and targets will be saved.</p> <p><code>concat_dim</code> is the batch dimension, where all the tensors will be concatenated.</p> <p><code>inner</code> is an internal attribute that tells <code>get_preds</code> it's called internally, inside another training loop, to avoid recursion errors.</p> <p>{% include note.html content='If you want to use the option <code>with_loss=True</code> on a custom loss function, make sure you have implemented a <code>reduction</code> attribute that supports ’none’ ' %}</p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span>n_train<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> metrics<span class="token operator">=</span>tst_metric<span class="token punctuation">)</span>
preds<span class="token punctuation">,</span>targs <span class="token operator">=</span> learn<span class="token punctuation">.</span>get_preds<span class="token punctuation">(</span><span class="token punctuation">)</span>
x<span class="token punctuation">,</span>y <span class="token operator">=</span> learn<span class="token punctuation">.</span>dls<span class="token punctuation">.</span>valid_ds<span class="token punctuation">.</span>tensors
test_eq<span class="token punctuation">(</span>targs<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
test_close<span class="token punctuation">(</span>preds<span class="token punctuation">,</span> learn<span class="token punctuation">.</span>model<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

preds<span class="token punctuation">,</span>targs <span class="token operator">=</span> learn<span class="token punctuation">.</span>get_preds<span class="token punctuation">(</span>act <span class="token operator">=</span> torch<span class="token punctuation">.</span>sigmoid<span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span>targs<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
test_close<span class="token punctuation">(</span>preds<span class="token punctuation">,</span> torch<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>model<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="Learner.predict" class="doc_header"><code>Learner.predict</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L243" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.predict</code>(<strong><code>item</code></strong>, <strong><code>rm_type_tfms</code></strong>=<em><code>None</code></em>, <strong><code>with_input</code></strong>=<em><code>False</code></em>)</p></blockquote> <p>Prediction on <code>item</code>, fully decoded, loss function decoded and probabilities</p> <p>It returns a tuple of three elements with, in reverse order,</p> <ul><li>the prediction from the model, potentially passed through the activation of the loss function (if it has one)</li> <li>the decoded prediction, using the potential <code>decodes</code> method from it</li> <li>the fully decoded prediction, using the transforms used to build the <a href="/fastai/data.core.html#Datasets"><code>Datasets</code></a>/<a href="/fastai/data.core.html#DataLoaders"><code>DataLoaders</code></a></li></ul> <p><code>rm_type_tfms</code> is a deprecated argument that should not be used and will be removed in a future version. <code>with_input</code> will add the decoded inputs to the result.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">_FakeLossFunc</span><span class="token punctuation">(</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    reduction <span class="token operator">=</span> <span class="token string">'none'</span>
    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">return</span> F<span class="token punctuation">.</span>mse_loss<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">activation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">return</span> x<span class="token operator">+</span><span class="token number">1</span>
    <span class="token keyword">def</span> <span class="token function">decodes</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token number">2</span><span class="token operator">*</span>x

<span class="token keyword">class</span> <span class="token class-name">_Add1</span><span class="token punctuation">(</span>Transform<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">encodes</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">return</span> x<span class="token operator">+</span><span class="token number">1</span>
    <span class="token keyword">def</span> <span class="token function">decodes</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">return</span> x<span class="token operator">-</span><span class="token number">1</span>
    
learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span>n_train<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
dl <span class="token operator">=</span> TfmdDL<span class="token punctuation">(</span>Datasets<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tfms <span class="token operator">=</span> <span class="token punctuation">[</span>L<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>_Add1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>dls <span class="token operator">=</span> DataLoaders<span class="token punctuation">(</span>dl<span class="token punctuation">,</span> dl<span class="token punctuation">)</span>
learn<span class="token punctuation">.</span>loss_func <span class="token operator">=</span> _FakeLossFunc<span class="token punctuation">(</span><span class="token punctuation">)</span>

inp <span class="token operator">=</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
out <span class="token operator">=</span> learn<span class="token punctuation">.</span>model<span class="token punctuation">(</span>inp<span class="token punctuation">)</span><span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>  <span class="token comment">#applying model + activation</span>
dec <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>out                        <span class="token comment">#decodes from loss function</span>
full_dec <span class="token operator">=</span> dec<span class="token operator">-</span><span class="token number">1</span>                   <span class="token comment">#decodes from _Add1</span>
test_eq<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>inp<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>full_dec<span class="token punctuation">,</span>dec<span class="token punctuation">,</span>out<span class="token punctuation">]</span><span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>inp<span class="token punctuation">,</span> with_input<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>inp<span class="token punctuation">,</span>full_dec<span class="token punctuation">,</span>dec<span class="token punctuation">,</span>out<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="Learner.show_results" class="doc_header"><code>Learner.show_results</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L254" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.show_results</code>(<strong><code>ds_idx</code></strong>=<em><code>1</code></em>, <strong><code>dl</code></strong>=<em><code>None</code></em>, <strong><code>max_n</code></strong>=<em><code>9</code></em>, <strong><code>shuffle</code></strong>=<em><code>True</code></em>, <strong>**<code>kwargs</code></strong>)</p></blockquote> <p>Show some predictions on <code>ds_idx</code>-th dataset or <code>dl</code></p> <p>Will show <code>max_n</code> samples (unless the batch size of <code>ds_idx</code> or <code>dl</code> is less than <code>max_n</code>, in which case it will show as many samples) and <code>shuffle</code> the data unless you pass <code>false</code> to that flag. <code>kwargs</code> are application-dependant.</p> <p>We can't show an example on our synthetic <a href="/fastai/learner.html#Learner"><code>Learner</code></a>, but check all the beginners tutorials which will show you how that method works across applications.</p> <p>The last functions in this section are used internally for inference, but should be less useful to you.</p> <h4 id="Learner.no_logging" class="doc_header"><code>Learner.no_logging</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L267" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.no_logging</code>()</p></blockquote> <p>Context manager to temporarily remove <code>logger</code></p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span>n_train<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> metrics<span class="token operator">=</span>tst_metric<span class="token punctuation">)</span>
<span class="token keyword">with</span> learn<span class="token punctuation">.</span>no_logging<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    test_stdout<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> learn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>logger<span class="token punctuation">,</span> <span class="token keyword">print</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="Learner.loss_not_reduced" class="doc_header"><code>Learner.loss_not_reduced</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L272" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.loss_not_reduced</code>()</p></blockquote> <p>A context manager to evaluate <code>loss_func</code> with reduction set to none.</p> <p>This requires your loss function to either have a <code>reduction</code> attribute or a <code>reduction</code> argument (like all fastai and PyTorch loss functions).</p> <h2 id="transfer-learning"><a href="#transfer-learning" class="header-anchor">#</a> Transfer learning</h2> <h4 id="Learner.freeze_to" class="doc_header"><code>Learner.freeze_to</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L496" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.freeze_to</code>(<strong><code>n</code></strong>)</p></blockquote> <p>Freeze parameter groups up to <code>n</code></p> <h4 id="Learner.freeze" class="doc_header"><code>Learner.freeze</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L502" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.freeze</code>()</p></blockquote> <p>Freeze up to last parameter group</p> <h4 id="Learner.unfreeze" class="doc_header"><code>Learner.unfreeze</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L505" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.unfreeze</code>()</p></blockquote> <p>Unfreeze the entire model</p> <h3 id="exporting-a-learner"><a href="#exporting-a-learner" class="header-anchor">#</a> Exporting a <a href="/fastai/learner.html#Learner"><code>Learner</code></a></h3> <h4 id="Learner.export" class="doc_header"><code>Learner.export</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L514" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.export</code>(<strong><code>fname</code></strong>=<em><code>'export.pkl'</code></em>, <strong><code>pickle_protocol</code></strong>=<em><code>2</code></em>)</p></blockquote> <p>Export the content of <code>self</code> without the items and the optimizer state for inference</p> <p>The <a href="/fastai/learner.html#Learner"><code>Learner</code></a> is saved in <code>self.path/fname</code>, using <code>pickle_protocol</code>. Note that serialization in Python saves the names of functions, not the code itself. Therefore, any custom code you have for models, data transformation, loss function etc... should be put in a module that you will import in your training environment before exporting, and in your deployment environment before loading it.</p> <h4 id="load_learner" class="doc_header"><code>load_learner</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L532" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>load_learner</code>(<strong><code>fname</code></strong>, <strong><code>cpu</code></strong>=<em><code>True</code></em>)</p></blockquote> <p>Load a <a href="/fastai/learner.html#Learner"><code>Learner</code></a> object in <code>fname</code>, optionally putting it on the <code>cpu</code></p> <p>{% include warning.html content='<a href="/fastai/learner.html#load_learner"><code>load_learner</code></a> requires all your custom code be in the exact same place as when exporting your <a href="/fastai/learner.html#Learner"><code>Learner</code></a> (the main script, or the module you imported it from).' %}</p> <h2 id="tta"><a href="#tta" class="header-anchor">#</a> TTA</h2> <h4 id="Learner.tta" class="doc_header"><code>Learner.tta</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L554" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.tta</code>(<strong><code>ds_idx</code></strong>=<em><code>1</code></em>, <strong><code>dl</code></strong>=<em><code>None</code></em>, <strong><code>n</code></strong>=<em><code>4</code></em>, <strong><code>item_tfms</code></strong>=<em><code>None</code></em>, <strong><code>batch_tfms</code></strong>=<em><code>None</code></em>, <strong><code>beta</code></strong>=<em><code>0.25</code></em>, <strong><code>use_max</code></strong>=<em><code>False</code></em>)</p></blockquote> <p>Return predictions on the <code>ds_idx</code> dataset or <code>dl</code> using Test Time Augmentation</p> <p>In practice, we get the predictions <code>n</code> times with the transforms of the training set and average those. The final predictions are <code>(1-beta)</code> multiplied by this average + <code>beta</code> multiplied by the predictions obtained with the transforms of the dataset. Set <code>beta</code> to <code>None</code> to get a tuple of the predictions and tta results. You can also use the maximum of all predictions instead of an average by setting <code>use_max=True</code>.</p> <p>If you want to use new transforms, you can pass them with <code>item_tfms</code> and <code>batch_tfms</code>.</p> <h2 id="gather-arguments"><a href="#gather-arguments" class="header-anchor">#</a> Gather arguments</h2> <h4 id="Learner.gather_args" class="doc_header"><code>Learner.gather_args</code><a href="https://github.com/fastai/fastai/tree/master/fastai/learner.py#L579" class="source_link" style="float:right;">[source]</a></h4> <blockquote><p><code>Learner.gather_args</code>()</p></blockquote> <p>Gather config parameters accessible to the learner</p> <div class="language-python extra-class"><pre class="language-python"><code>learn <span class="token operator">=</span> synth_learner<span class="token punctuation">(</span>lr<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>
test_eq<span class="token punctuation">(</span>learn<span class="token punctuation">.</span>init_args<span class="token punctuation">[</span><span class="token string">'Learner.__init__.lr'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/fastai/assets/js/app.e4c088e4.js" defer></script><script src="/fastai/assets/js/2.f1c4f916.js" defer></script><script src="/fastai/assets/js/30.248393fd.js" defer></script>
  </body>
</html>
