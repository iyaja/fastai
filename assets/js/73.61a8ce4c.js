(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{413:function(t,s,e){"use strict";e.r(s);var a=e(42),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"dynamic-unet"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dynamic-unet"}},[t._v("#")]),t._v(" Dynamic UNet")]),t._v(" "),e("blockquote",[e("p",[t._v("Unet model using PixelShuffle ICNR upsampling that can be built on top of any pretrained architecture")])]),t._v(" "),e("h2",{staticClass:"doc_header",attrs:{id:"UnetBlock"}},[e("code",[t._v("class")]),t._v(" "),e("code",[t._v("UnetBlock")]),e("a",{staticClass:"source_link",staticStyle:{float:"right"},attrs:{href:"https://github.com/fastai/fastai/tree/master/fastai/vision/models/unet.py#L18"}},[t._v("[source]")])]),t._v(" "),e("blockquote",[e("p",[e("code",[t._v("UnetBlock")]),t._v("("),e("strong",[e("code",[t._v("up_in_c")])]),t._v(", "),e("strong",[e("code",[t._v("x_in_c")])]),t._v(", "),e("strong",[e("code",[t._v("hook")])]),t._v(", "),e("strong",[e("code",[t._v("final_div")])]),t._v("="),e("em",[e("code",[t._v("True")])]),t._v(", "),e("strong",[e("code",[t._v("blur")])]),t._v("="),e("em",[e("code",[t._v("False")])]),t._v(", "),e("strong",[e("code",[t._v("act_cls")])]),t._v("="),e("em",[e("code",[t._v("ReLU")])]),t._v(", "),e("strong",[e("code",[t._v("self_attention")])]),t._v("="),e("em",[e("code",[t._v("False")])]),t._v(", "),e("strong",[e("code",[t._v("init")])]),t._v("="),e("em",[e("code",[t._v("kaiming_normal_")])]),t._v(", "),e("strong",[e("code",[t._v("norm_type")])]),t._v("="),e("em",[e("code",[t._v("None")])]),t._v(", "),e("strong",[e("code",[t._v("ks")])]),t._v("="),e("em",[e("code",[t._v("3")])]),t._v(", "),e("strong",[e("code",[t._v("stride")])]),t._v("="),e("em",[e("code",[t._v("1")])]),t._v(", "),e("strong",[e("code",[t._v("padding")])]),t._v("="),e("em",[e("code",[t._v("None")])]),t._v(", "),e("strong",[e("code",[t._v("bias")])]),t._v("="),e("em",[e("code",[t._v("None")])]),t._v(", "),e("strong",[e("code",[t._v("ndim")])]),t._v("="),e("em",[e("code",[t._v("2")])]),t._v(", "),e("strong",[e("code",[t._v("bn_1st")])]),t._v("="),e("em",[e("code",[t._v("True")])]),t._v(", "),e("strong",[e("code",[t._v("transpose")])]),t._v("="),e("em",[e("code",[t._v("False")])]),t._v(", "),e("strong",[e("code",[t._v("xtra")])]),t._v("="),e("em",[e("code",[t._v("None")])]),t._v(", "),e("strong",[e("code",[t._v("bias_std")])]),t._v("="),e("em",[e("code",[t._v("0.01")])]),t._v(", "),e("strong",[e("code",[t._v("dilation")])]),t._v(":"),e("code",[t._v("Union")]),t._v("["),e("code",[t._v("int")]),t._v(", "),e("code",[t._v("Tuple")]),t._v("["),e("code",[t._v("int")]),t._v(", "),e("code",[t._v("int")]),t._v("]]="),e("em",[e("code",[t._v("1")])]),t._v(", "),e("strong",[e("code",[t._v("groups")])]),t._v(":"),e("code",[t._v("int")]),t._v("="),e("em",[e("code",[t._v("1")])]),t._v(", "),e("strong",[e("code",[t._v("padding_mode")])]),t._v(":"),e("code",[t._v("str")]),t._v("="),e("em",[e("code",[t._v("'zeros'")])]),t._v(") :: "),e("RouterLink",{attrs:{to:"/torch_core.html#Module"}},[e("code",[t._v("Module")])])],1)]),t._v(" "),e("p",[t._v("A quasi-UNet block, using "),e("code",[t._v("PixelShuffle_ICNR upsampling")]),t._v(".")]),t._v(" "),e("h2",{staticClass:"doc_header",attrs:{id:"ResizeToOrig"}},[e("code",[t._v("class")]),t._v(" "),e("code",[t._v("ResizeToOrig")]),e("a",{staticClass:"source_link",staticStyle:{float:"right"},attrs:{href:"https://github.com/fastai/fastai/tree/master/fastai/vision/models/unet.py#L44"}},[t._v("[source]")])]),t._v(" "),e("blockquote",[e("p",[e("code",[t._v("ResizeToOrig")]),t._v("("),e("strong",[e("code",[t._v("mode")])]),t._v("="),e("em",[e("code",[t._v("'nearest'")])]),t._v(") :: "),e("RouterLink",{attrs:{to:"/torch_core.html#Module"}},[e("code",[t._v("Module")])])],1)]),t._v(" "),e("p",[t._v("Merge a shortcut with the result of the module by adding them or concatenating them if "),e("code",[t._v("dense=True")]),t._v(".")]),t._v(" "),e("h2",{staticClass:"doc_header",attrs:{id:"DynamicUnet"}},[e("code",[t._v("class")]),t._v(" "),e("code",[t._v("DynamicUnet")]),e("a",{staticClass:"source_link",staticStyle:{float:"right"},attrs:{href:"https://github.com/fastai/fastai/tree/master/fastai/vision/models/unet.py#L53"}},[t._v("[source]")])]),t._v(" "),e("blockquote",[e("p",[e("code",[t._v("DynamicUnet")]),t._v("("),e("strong",[e("code",[t._v("encoder")])]),t._v(", "),e("strong",[e("code",[t._v("n_classes")])]),t._v(", "),e("strong",[e("code",[t._v("img_size")])]),t._v(", "),e("strong",[e("code",[t._v("blur")])]),t._v("="),e("em",[e("code",[t._v("False")])]),t._v(", "),e("strong",[e("code",[t._v("blur_final")])]),t._v("="),e("em",[e("code",[t._v("True")])]),t._v(", "),e("strong",[e("code",[t._v("self_attention")])]),t._v("="),e("em",[e("code",[t._v("False")])]),t._v(", "),e("strong",[e("code",[t._v("y_range")])]),t._v("="),e("em",[e("code",[t._v("None")])]),t._v(", "),e("strong",[e("code",[t._v("last_cross")])]),t._v("="),e("em",[e("code",[t._v("True")])]),t._v(", "),e("strong",[e("code",[t._v("bottle")])]),t._v("="),e("em",[e("code",[t._v("False")])]),t._v(", "),e("strong",[e("code",[t._v("act_cls")])]),t._v("="),e("em",[e("code",[t._v("ReLU")])]),t._v(", "),e("strong",[e("code",[t._v("init")])]),t._v("="),e("em",[e("code",[t._v("kaiming_normal_")])]),t._v(", "),e("strong",[e("code",[t._v("norm_type")])]),t._v("="),e("em",[e("code",[t._v("None")])]),t._v(", "),e("strong",[t._v("**"),e("code",[t._v("kwargs")])]),t._v(") :: "),e("RouterLink",{attrs:{to:"/layers.html#SequentialEx"}},[e("code",[t._v("SequentialEx")])])],1)]),t._v(" "),e("p",[t._v("Create a U-Net from a given architecture.")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" fastai"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("vision"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("models "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" resnet34\n")])])]),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[t._v("m "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" resnet34"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nm "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nn"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sequential"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("m"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntst "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" DynamicUnet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("m"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" norm_type"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nx "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("randn"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ny "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tst"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntest_eq"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("y"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shape"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[t._v("tst "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" DynamicUnet"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("m"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" norm_type"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nx "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("randn"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("127")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ny "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tst"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);